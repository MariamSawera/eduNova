<html>
  <head>
    <title>23Connect - Announcements</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      type="image/png"
      sizes="96x96"
      rel="icon"
      href="./images/icons8-star-filled-96.png"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav>
      <div class="logo">23Connect</div>
      <div class="menu-toggle" id="menu-toggle">&#9776;</div>
      <ul id="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="semester6.html">Semester</a></li>
        <li><a href="announcement.html" class="active">Announcement</a></li>
        <li><a href="subjects.html">Subjects</a></li>
        <li><a href="books.html">Books</a></li>
        <li><a href="resources.html">Resources</a></li>
        <li><a href="assignments.html">Assignments</a></li>
        <!-- <li><a href="events.html">Events</a></li> -->
        <li><a href="exams.html">Exams</a></li>
        <li><a href="help.html">Help</a></li>
        <li><a href="gallery.html">Gallery</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>

    <div class="hero"></div>

    <h1 class="heading1">Announcements</h1>
    <div class="intro">
      <p class="heading">Stay updated with class Announcements</p>
    </div>

    <section class="announcementAll-section" id="announcementAll-section">
      <!-- Announcements will be loaded here -->
    </section>

    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2025 <strong>23Connect</strong>. All rights reserved.</p>
        <p>
          Managed by <strong>Mariam Sawera</strong> â€” Batch 2k23 IT, University
          of Sindh
        </p>
        <a href="https://www.flaticon.com/" title="icons"
          >All icons from - Flaticon</a
        >
        <div class="social-icons">
          <a href="#"><i class="fab fa-facebook-f"></i></a>
          <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="https://www.linkedin.com/in/mariamsawera?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"><i class="fab fa-linkedin-in"></i></a>
          <a href="#"><i class="fab fa-github"></i></a>
        </div>
      </div>
    </footer>

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import {
        getFirestore,
        collection,
        getDocs,
        query,
        orderBy,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyAimgzLLLpv6t-d7pX2cOESO0nZWeyrUIM",
        authDomain: "studenthub-98003.firebaseapp.com",
        projectId: "studenthub-98003",
        storageBucket: "studenthub-98003.appspot.com",
        messagingSenderId: "881188750242",
        appId: "1:881188750242:web:8f5037df0d41e89aec28fb",
        measurementId: "G-VR64EWLZGM",
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      async function loadAnnouncements() {
        const section = document.getElementById("announcementAll-section");
        section.innerHTML = "<p>Loading announcements...</p>";

        try {
          const q = query(
            collection(db, "announcements"),
            orderBy("DueDate", "desc")
          );
          const snapshot = await getDocs(q);

          if (snapshot.empty) {
            section.innerHTML = "<p>No announcements found.</p>";
            return;
          }

          section.innerHTML = "";
          snapshot.forEach((doc) => {
            const data = doc.data();
            const dueDate = data.DueDate ? data.DueDate.toDate() : null;
            const today = new Date();

            let statusText = "Ongoing";
            let statusClass = "ongoing";

            if (dueDate && dueDate < today) {
              statusText = "Completed";
              statusClass = "completed";
            }

            const due = dueDate
              ? dueDate.toLocaleDateString()
              : "No due date";

            const card = document.createElement("div");
            card.className = "announcementAll-card";
            card.innerHTML = `
              <div class="status ${statusClass}">${statusText}</div>
              <div class="icon">
                <img src="${
                  data.iconURL ||
                  "https://cdn-icons-png.flaticon.com/512/2910/2910768.png"
                }" alt="icon">
              </div>
              <div class="content">
                <h3>${data.Title || "Untitled"}</h3>
                <p>${data.Description || "No description provided."}</p>
                <p class="due-date">Due: ${due}</p>
                ${
                  data.link
                    ? `<a href="${data.link}" target="_blank" class="announcementAll-link">View Details</a>`
                    : ""
                }
              </div>
            `;
            section.appendChild(card);
          });
        } catch (error) {
          section.innerHTML = `<p style="color:red;">Error loading announcements: ${error.message}</p>`;
          console.error(error);
        }
      }

      loadAnnouncements();
    </script>
    <script src="script.js"></script>
    
  </body>
</html>
