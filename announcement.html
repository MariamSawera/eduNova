<html>
  <head>
    <title>Klasync - Announcements</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      type="image/png"
      sizes="96x96"
      rel="icon"
      href="./images/icons8-star-filled-96.png"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav>
      <div class="logo">Klasync</div>
      <div class="menu-toggle" id="menu-toggle">&#9776;</div>
      <ul id="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="index.html#semester">Semesters</a></li>
        <li><a href="announcement.html" class="active">Announcement</a></li>
        <li><a href="subjects.html">Subjects</a></li>
        <li><a href="books.html">Books</a></li>
        <li><a href="resources.html">Resources</a></li>
        <li><a href="assignments.html">Assignments</a></li>
        <li><a href="events.html">Events</a></li>
        <li><a href="exams.html">Exams</a></li>
        <li><a href="help.html">Help</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="gallery.html">Gallery</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>

    <div class="hero"></div>

    <h1 class="heading">Announcements</h1>
    <div class="intro">
      <p>Stay updated with class Announcements</p>
    </div>

    <section class="announcementAll-section" id="announcementAll-section">
      <!-- Announcements will be loaded here -->
    </section>

    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2025 <strong>Klasync</strong>. All rights reserved.</p>
        <p>
          Managed by <strong>Mariam Sawera</strong> â€” Batch 2k23 IT, University of Sindh
        </p>
        <a href="https://www.flaticon.com/" title="icons">All icons from - Flaticon</a>
        <div class="social-icons">
          <a href="#"><i class="fab fa-facebook-f"></i></a>
          <a href="#"><i class="fab fa-twitter"></i></a>
          <a href="#"><i class="fab fa-linkedin-in"></i></a>
          <a href="#"><i class="fab fa-github"></i></a>
        </div>
      </div>
    </footer>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyAimgzLLLpv6t-d7pX2cOESO0nZWeyrUIM",
        authDomain: "studenthub-98003.firebaseapp.com",
        projectId: "studenthub-98003",
        storageBucket: "studenthub-98003.appspot.com", // FIXED
        messagingSenderId: "881188750242",
        appId: "1:881188750242:web:8f5037df0d41e89aec28fb",
        measurementId: "G-VR64EWLZGM"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      async function loadAnnouncements() {
        const section = document.getElementById("announcementAll-section");
        section.innerHTML = "<p>Loading announcements...</p>";

        try {
          const snapshot = await getDocs(collection(db, "announcements"));

          if (snapshot.empty) {
            section.innerHTML = "<p>No announcements found.</p>";
            return;
          }

          section.innerHTML = "";
          snapshot.forEach(doc => {
            const data = doc.data();
            const due = data.DueDate
              ? new Date(data.DueDate).toLocaleDateString()
              : "No due date";

            const card = document.createElement("div");
            card.className = "announcementAll-card";
            card.innerHTML = `
              <div class="icon">
                <img src="${data.iconURL || 'https://cdn-icons-png.flaticon.com/512/2910/2910768.png'}" alt="icon">
              </div>
              <div class="content">
                <h3>${data.Title || "Untitled"}</h3>
                <p>${data.Description || "No description provided."}</p>
                <p class="due-date">Due: ${due}</p>
                ${data.link ? `<a href="${data.link}" target="_blank" class="announcementAll-link">View Details</a>` : ""}
              </div>
            `;
            section.appendChild(card);
          });
        } catch (error) {
          section.innerHTML = `<p style="color:red;">Error loading announcements: ${error.message}</p>`;
          console.error(error);
        }
      }

      loadAnnouncements();
    </script>
    <script src="script.js"></script>
  </body>
</html>
